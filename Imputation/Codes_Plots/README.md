# Set of Scripts to Plot Results of Imputation and Pruning Steps

## A. `analyze_vcf.sh`
To analyze VCF files before and after imputation.

### Usage:
```bash
bash analyze_vcf.sh file.vcf.gz [a or b]Imputation
```

**Inputs:**
- `file.vcf.gz`: VCF file to analyze.
- `output`: Name of the output.

**Outputs:**
- `summary_output.pdf`: PDF file generated by vcftools.
- `output_output_PSC.vchk`: Metrics of the file.

## B. `Plot_NA_Imputation.R`
Local script to plot the number of missing positions inferred after imputation.

**Input:** 
- `.vchk` files for each VCF before and after imputation for each population, obtained by running `analyze_vcf.sh`.

**Output:** 
- `Impact_Imputation.pdf`: Number of missing positions inferred.

## `Plot_Nbr_SNP_aImputation.R`
Local script to plot the number of SNPs after imputation and shared SNPs between populations.

**Input:** 
- `.*.imputed_snp_positions.csv`: Generated with `Get_position.R` applied to imputed files after the final filtering step (hard-filtering).

**Outputs:** 
- `Number_SNPs_aImputation.pdf`: Bar plot of SNP numbers after imputation.
- `Shared_SNPs_pop.pdf`: Comparison of each population to compute how many SNPs they share, plotted with a bar plot.
- `Heatmap_shared_SNPs.pdf`: Heatmap summarizing all previous results.

## `PlotPruning.R`
Local script to plot the results of the pruning step.

**Input:** 
- `summary_imputation.csv`: Results from `Summarize_imputation.sh`.

**Outputs:** 
- `BarPlot_pruning.pdf`: Plot of the number of SNPs per threshold of pruning in each population.
- `Reduce_BarPlot_pruning.pdf`: Plot showing only A6 and founders.

